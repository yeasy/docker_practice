## 4.2 åˆ—å‡ºé•œåƒ

## åˆ—å‡ºé•œåƒ

åœ¨ä¸‹è½½äº†é•œåƒåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `docker image ls` å‘½ä»¤åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒã€‚

### åŸºæœ¬ç”¨æ³•

æŸ¥çœ‹æœ¬åœ°å·²ä¸‹è½½çš„é•œåƒï¼š

```bash
$ docker image ls
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
redis        latest    5f515359c7f8   5 days ago     183MB
nginx        latest    05a60462f8ba   5 days ago     181MB
ubuntu       24.04     329ed837d508   3 days ago     78MB
ubuntu       noble     329ed837d508   3 days ago     78MB
```

> ğŸ’¡ `docker images` æ˜¯ `docker image ls` çš„ç®€å†™ï¼Œä¸¤è€…ç­‰æ•ˆã€‚

---

### è¾“å‡ºå­—æ®µè¯´æ˜

`docker image ls` å‘½ä»¤é»˜è®¤è¾“å‡ºçš„åˆ—è¡¨åŒ…å«ä»“åº“åã€æ ‡ç­¾ã€é•œåƒ IDã€åˆ›å»ºæ—¶é—´å’Œå ç”¨ç©ºé—´ç­‰ä¿¡æ¯ã€‚

| å­—æ®µ | è¯´æ˜ |
|------|------|
| **REPOSITORY** | ä»“åº“å |
| **TAG** | æ ‡ç­¾ï¼ˆç‰ˆæœ¬ï¼‰ |
| **IMAGE ID** | é•œåƒå”¯ä¸€æ ‡è¯†ï¼ˆçŸ­ IDï¼Œå‰ 12 ä½ï¼‰ |
| **CREATED** | åˆ›å»ºæ—¶é—´ |
| **SIZE** | æœ¬åœ°å ç”¨ç©ºé—´ |

#### åŒä¸€é•œåƒå¤šä¸ªæ ‡ç­¾

æ³¨æ„ä¸Šé¢çš„ `ubuntu:24.04` å’Œ `ubuntu:noble` æ‹¥æœ‰ç›¸åŒçš„ IMAGE IDâ€”â€”å®ƒä»¬æ˜¯åŒä¸€ä¸ªé•œåƒçš„ä¸åŒæ ‡ç­¾ï¼Œåªå ç”¨ä¸€ä»½å­˜å‚¨ç©ºé—´ã€‚

---

### ç†è§£é•œåƒå¤§å°

Docker é•œåƒçš„å¤§å°å¯èƒ½ä¸æˆ‘ä»¬é€šå¸¸ç†è§£çš„æ–‡ä»¶å¤§å°æœ‰æ‰€ä¸åŒï¼Œè¿™æ¶‰åŠåˆ°åˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µã€‚

#### æœ¬åœ°å¤§å° vs Hub æ˜¾ç¤ºå¤§å°

| ä½ç½® | æ˜¾ç¤ºå¤§å° | è¯´æ˜ |
|------|---------|------|
| Docker Hub | 29MB | å‹ç¼©åçš„ç½‘ç»œä¼ è¾“å¤§å° |
| docker image ls | 78MB | æœ¬åœ°è§£å‹åçš„å®é™…å¤§å° |

#### å®é™…ç£ç›˜å ç”¨

ç”±äºé•œåƒæ˜¯åˆ†å±‚å­˜å‚¨ï¼Œä¸åŒé•œåƒå¯èƒ½å…±äº«ç›¸åŒçš„å±‚ï¼š

```
ubuntu:24.04    nginx:latest    redis:latest
    â”‚               â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
            â–¼                        â”‚
       å…±äº«åŸºç¡€å±‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

å› æ­¤ï¼Œ`docker image ls` ä¸­å„é•œåƒå¤§å°ä¹‹å’Œ > å®é™…ç£ç›˜å ç”¨ã€‚

#### æŸ¥çœ‹å®é™…ç©ºé—´å ç”¨

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker system df
TYPE            TOTAL   ACTIVE   SIZE      RECLAIMABLE
Images          15      3        2.5GB     1.8GB (72%)
Containers      5       2        100MB     80MB (80%)
Local Volumes   8       2        500MB     400MB (80%)
Build Cache     0       0        0B        0B
```

---

### è¿‡æ»¤é•œåƒ

éšç€æœ¬åœ°é•œåƒæ•°é‡çš„å¢åŠ ï¼Œæˆ‘ä»¬éœ€è¦æ›´æœ‰æ•ˆçš„æ–¹å¼æ¥æŸ¥æ‰¾ç‰¹å®šçš„é•œåƒã€‚Docker æä¾›äº†å¤šç§è¿‡æ»¤æ–¹å¼ã€‚

#### æŒ‰ä»“åº“åè¿‡æ»¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
## åˆ—å‡ºæ‰€æœ‰ ubuntu é•œåƒ

$ docker images ubuntu
REPOSITORY   TAG     IMAGE ID       SIZE
ubuntu       24.04   329ed837d508   78MB
ubuntu       noble   329ed837d508   78MB
ubuntu       22.04   a1b2c3d4e5f6   72MB
```

#### æŒ‰ä»“åº“åå’Œæ ‡ç­¾è¿‡æ»¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker images ubuntu:24.04
REPOSITORY   TAG     IMAGE ID       SIZE
ubuntu       24.04   329ed837d508   78MB
```

#### ä½¿ç”¨è¿‡æ»¤å™¨ --filter

| è¿‡æ»¤æ¡ä»¶ | è¯´æ˜ | ç¤ºä¾‹ |
|---------|------|------|
| `dangling=true` | è™šæ‚¬é•œåƒ | `-f dangling=true` |
| `before=é•œåƒ` | åœ¨æŸé•œåƒä¹‹å‰åˆ›å»º | `-f before=nginx:latest` |
| `since=é•œåƒ` | åœ¨æŸé•œåƒä¹‹ååˆ›å»º | `-f since=nginx:latest` |
| `label=key=value` | æŒ‰ LABEL è¿‡æ»¤ | `-f label=version=1.0` |
| `reference=pattern` | æŒ‰åç§°æ¨¡å¼ | `-f reference='*:latest'` |

```bash
## åˆ—å‡º nginx ä¹‹ååˆ›å»ºçš„é•œåƒ

$ docker images -f since=nginx:latest

## åˆ—å‡ºæ‰€æœ‰å¸¦ latest æ ‡ç­¾çš„é•œåƒ

$ docker images -f reference='*:latest'

## åˆ—å‡ºå¸¦ç‰¹å®š LABEL çš„é•œåƒ

$ docker images -f label=maintainer=example@email.com
```

---

### è™šæ‚¬é•œåƒï¼ˆDangling Imagesï¼‰

åœ¨é•œåƒåˆ—è¡¨é‡Œï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›ä»“åº“åå’Œæ ‡ç­¾éƒ½ä¸º `<none>` çš„é•œåƒï¼Œè¿™ç±»é•œåƒè¢«ç§°ä¸ºè™šæ‚¬é•œåƒã€‚

#### ä»€ä¹ˆæ˜¯è™šæ‚¬é•œåƒ

ä»“åº“åå’Œæ ‡ç­¾éƒ½æ˜¾ç¤ºä¸º `<none>` çš„é•œåƒï¼š

```bash
$ docker images
REPOSITORY   TAG       IMAGE ID       SIZE
<none>       <none>    00285df0df87   342MB
```

#### äº§ç”ŸåŸå› 

1. **é•œåƒé‡æ–°æ„å»º**ï¼šæ–°é•œåƒä½¿ç”¨äº†æ—§é•œåƒçš„æ ‡ç­¾ï¼Œæ—§é•œåƒæ ‡ç­¾è¢«ç§»é™¤
2. **docker pull æ›´æ–°**ï¼šæ‹‰å–æ›´æ–°ç‰ˆæœ¬æ—¶ï¼Œæ—§ç‰ˆæœ¬å¤±å»æ ‡ç­¾

#### å¤„ç†è™šæ‚¬é•œåƒ

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
## åˆ—å‡ºè™šæ‚¬é•œåƒ

$ docker images -f dangling=true

## åˆ é™¤è™šæ‚¬é•œåƒ

$ docker image prune
```

---

### ä¸­é—´å±‚é•œåƒ

é™¤äº†è™šæ‚¬é•œåƒï¼Œ`docker image ls` é»˜è®¤åˆ—å‡ºçš„åªæ˜¯é¡¶å±‚é•œåƒã€‚è¿˜æœ‰ä¸€ç§é•œåƒæ˜¯ä¸ºäº†åŠ é€Ÿé•œåƒæ„å»ºã€é‡å¤åˆ©ç”¨èµ„æºè€Œå­˜åœ¨çš„ä¸­é—´å±‚é•œåƒã€‚

#### æŸ¥çœ‹æ‰€æœ‰é•œåƒï¼ˆåŒ…å«ä¸­é—´å±‚ï¼‰

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker images -a
```

ä¼šæ˜¾ç¤ºå¾ˆå¤šæ— æ ‡ç­¾é•œåƒâ€”â€”è¿™äº›æ˜¯æ„å»ºè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸­é—´å±‚ï¼Œè¢«å…¶ä»–é•œåƒä¾èµ–ã€‚

> âš ï¸ ä¸è¦åˆ é™¤ä¸­é—´å±‚é•œåƒã€‚å®ƒä»¬æ˜¯å…¶ä»–é•œåƒçš„ä¾èµ–ï¼Œåˆ é™¤ä¼šå¯¼è‡´ä¸Šå±‚é•œåƒæ— æ³•ä½¿ç”¨ã€‚åˆ é™¤é¡¶å±‚é•œåƒæ—¶ä¼šè‡ªåŠ¨æ¸…ç†ä¸å†éœ€è¦çš„ä¸­é—´å±‚ã€‚

---

### æ ¼å¼åŒ–è¾“å‡º

ä¸ºäº†é…åˆè„šæœ¬ä½¿ç”¨æˆ–å±•ç¤ºæ›´å…³æ³¨çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `--format` å‚æ•°æ¥è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼ã€‚

#### åªè¾“å‡º ID

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker images -q
5f515359c7f8
05a60462f8ba
329ed837d508
```

å¸¸ç”¨äºé…åˆå…¶ä»–å‘½ä»¤ï¼š

```bash
## åˆ é™¤æ‰€æœ‰é•œåƒ

$ docker rmi $(docker images -q)

## åˆ é™¤æ‰€æœ‰ redis é•œåƒ

$ docker rmi $(docker images -q redis)
```

#### æ˜¾ç¤ºå®Œæ•´ ID

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker images --no-trunc
```

#### æ˜¾ç¤ºæ‘˜è¦

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ docker images --digests
REPOSITORY   TAG     DIGEST                    IMAGE ID
nginx        latest  sha256:b4f0e0bdeb5...    e43d811ce2f4
```

#### è‡ªå®šä¹‰æ ¼å¼

ä½¿ç”¨ Go æ¨¡æ¿è¯­æ³•è‡ªå®šä¹‰è¾“å‡ºï¼š

```bash
## åªæ˜¾ç¤º ID å’Œä»“åº“å

$ docker images --format "{{.ID}}: {{.Repository}}"
5f515359c7f8: redis
05a60462f8ba: nginx
329ed837d508: ubuntu

## è¡¨æ ¼å½¢å¼ï¼ˆå¸¦æ ‡é¢˜ï¼‰

$ docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}"
REPOSITORY   TAG       SIZE
redis        latest    183MB
nginx        latest    181MB
ubuntu       24.04     78MB
```

#### å¯ç”¨æ¨¡æ¿å­—æ®µ

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `.ID` | é•œåƒ ID |
| `.Repository` | ä»“åº“å |
| `.Tag` | æ ‡ç­¾ |
| `.Digest` | æ‘˜è¦ |
| `.CreatedSince` | åˆ›å»ºåç»è¿‡çš„æ—¶é—´ |
| `.CreatedAt` | åˆ›å»ºæ—¶é—´ |
| `.Size` | å¤§å° |

---

### å¸¸ç”¨å‘½ä»¤ç»„åˆ

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
## åˆ—å‡ºæ‰€æœ‰é•œåƒåŠå…¶å¤§å°ï¼ŒæŒ‰å¤§å°æ’åºï¼ˆéœ€è¦ç³»ç»Ÿ sort å‘½ä»¤ï¼‰

$ docker images --format "{{.Size}}\t{{.Repository}}:{{.Tag}}" | sort -h

## æŸ¥æ‰¾å¤§äº 500MB çš„é•œåƒ

$ docker images --format "{{.Size}}\t{{.Repository}}:{{.Tag}}" | grep -E "^[0-9]+GB|^[5-9][0-9]{2}MB"

## å¯¼å‡ºé•œåƒåˆ—è¡¨

$ docker images --format "{{.Repository}}:{{.Tag}}" > images.txt
```

---

### æœ¬ç« å°ç»“

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| åˆ—å‡ºæ‰€æœ‰é•œåƒ | `docker images` |
| æŒ‰ä»“åº“åè¿‡æ»¤ | `docker images nginx` |
| åˆ—å‡ºè™šæ‚¬é•œåƒ | `docker images -f dangling=true` |
| åªè¾“å‡º ID | `docker images -q` |
| æ˜¾ç¤ºæ‘˜è¦ | `docker images --digests` |
| è‡ªå®šä¹‰æ ¼å¼ | `docker images --format "..."` |
| æŸ¥çœ‹ç©ºé—´å ç”¨ | `docker system df` |

### å»¶ä¼¸é˜…è¯»

- [è·å–é•œåƒ](4.1_pull.md)ï¼šä» Registry æ‹‰å–é•œåƒ
- [åˆ é™¤é•œåƒ](4.3_rm.md)ï¼šæ¸…ç†æœ¬åœ°é•œåƒ
- [é•œåƒ](../02_basic_concept/2.1_image.md)ï¼šç†è§£é•œåƒæ¦‚å¿µ
